<!-- {# templates/components/questions/_panel_subjects.html #} -->
<div class="card-soft p-3">
  <h5 class="mb-3">Subjects</h5>

  {% if subjects %}
    <div class="list-group">
      {% for s in subjects %}
        {% if source == "exams" %}
          {# Exams العادية → لازم part #}
          <button
            class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
            hx-get="{% url 'q_panel_parts' %}?module_id={{ module_id }}&subject_id={{ s.id }}&source=exams"
            hx-target="#q-main-panel"
            hx-swap="innerHTML"
            hx-indicator="#q-loading"
          >
            <span>{{ s.name }}</span>
            <span class="badge bg-light text-muted">open</span>
          </button>

        {% elif source == "old" %}
          {# Old Exams #}
          {% if kind == "final" %}
            {# Old Finals → part → questions #}
            <button
              class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
              hx-get="{% url 'q_panel_parts' %}?module_id={{ module_id }}&subject_id={{ s.id }}&source=old&kind=final&exam_year={{ exam_year }}"
              hx-target="#q-main-panel"
              hx-swap="innerHTML"
              hx-indicator="#q-loading"
            >
              <span>{{ s.name }}</span>
              <span class="badge bg-light text-muted">open</span>
            </button>
          {% else %}
            {# Old MidTerm / TPL / Flipped → questions مباشرة #}
            <button
              class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
              hx-get="{% url 'q_panel_questions' %}?subject_id={{ s.id }}&source=old&kind={{ kind }}&exam_year={{ exam_year }}"
              hx-target="#q-main-panel"
              hx-swap="innerHTML"
              hx-indicator="#q-loading"
            >
              <span>{{ s.name }}</span>
              <span class="badge bg-light text-muted">questions</span>
            </button>
          {% endif %}

        {% elif source == "exam_review" %}
          {# Exam review #}
          {% if kind == "final" %}
            {# Exam review finals → محتاجة part → chapters → lessons #}
            <button
              class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
              hx-get="{% url 'q_panel_parts' %}?subject_id={{ s.id }}&source=exam_review&kind=final&exam_year={{ exam_year }}"
              hx-target="#q-main-panel"
              hx-swap="innerHTML"
              hx-indicator="#q-loading"
            >
              <span>{{ s.name }}</span>
              <span class="badge bg-light text-muted">open</span>
            </button>
          {% else %}
            {# exam_review midterm/tpl/flipped → chapters على طول #}
            <button
              class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
              hx-get="{% url 'q_panel_chapters' %}?subject_id={{ s.id }}&source=exam_review&kind={{ kind }}&exam_year={{ exam_year }}"
              hx-target="#q-main-panel"
              hx-swap="innerHTML"
              hx-indicator="#q-loading"
            >
              <span>{{ s.name }}</span>
              <span class="badge bg-light text-muted">open</span>
            </button>
          {% endif %}
        {% else %}
          <div class="list-group-item">{{ s.name }}</div>
        {% endif %}
      {% endfor %}
    </div>
  {% else %}
    <p class="text-muted mb-0">No subjects.</p>
  {% endif %}
</div>
